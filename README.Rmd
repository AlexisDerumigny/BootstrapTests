---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)


set.seed(1)
```

# Package BootstrapTests

<!-- badges: start -->
<!-- badges: end -->

This package BootstrapTests implements several methods to perform bootstrap-based 
hypothesis testing procedures on three statistical problems: independence testing,
testing the slope in a linear regression setting, and goodness-of-fit testing.

## Installation

You can install the development version of BootstrapTests from [GitHub](https://github.com/)
using the `devtools` package with:

``` r
# install.packages("devtools")
devtools::install_github("AlexisDerumigny/BootstrapTests")
```

## Examples

The following three subsections will showcase the use of the 'BootstrapTests'
package for the independence hypothesis testing, testing whether or not the slope 
is zero in a linear regression setting, and goodness-of-fit testing. 
In particular, we will show the use of the functions that implement these:

- `perform_independence_test.R`
- `perform_regression_test.R`
- `perform_GoF_test.R`

### Independence testing

We perform a hypothesis test of statistical independence by means of bootstrapping.
The null hypothesis is that of independence between the two random variables,
versus the alternative of dependence between them.
This procedure gives a total of 8 combinations of bootstrap resampling schemes
(nonparametric and independent), test statistics (centered and equivalent),
and Kolmogorov-Smirnov or L2-type of true test statistic. This function
gives the corresponding p-values, the true test statistic and the
bootstrap-version test statistics. The default (and valid) method implemented
in this function is the null bootstrap, together with the equivalent test
statistic and Kolmogorov-Smirnov test statistic.
Via the \code{bootstrapOptions} argument, the user can specify other
bootstrap resampling schemes and test statistics.

```{r example independence}
library(BootstrapTests)
n <- 100

# Under H1
X1 <- rnorm(n)
X2 <- X1 + rnorm(n)
result <- perform_independence_test(
  X1, X2, nBootstrap = 100,
  bootstrapOptions = list(type_boot = "indep",
                          type_stat = "eq",
                          norm_type = "KS") )
print(result)
plot(result)

# Under H0
X1 <- rnorm(n)
X2 <- rnorm(n)
result <- perform_independence_test(X1, X2)
print(result)
plot(result)


# Showing all theoretically valid options:
result_valid <- perform_independence_test(X1, X2, bootstrapOptions = "all")
print(result_valid)

# Showing all bootstrap combinations, including invalid options:
result_invalid <- perform_independence_test(X1, X2, bootstrapOptions = "all and also invalid")
print(result_invalid)
```


### Slope testing in linear regression setting

This function performs a bootstrap regression test for given data X,Y.
The null hypothesis corresponds of a slope coefficient of zero, versus the
alternative hypothesis of a non-zero slope coefficient.
It uses an independence/null bootstrap \code{"indep"}, a non-parametric \code{"NP"},
a residual bootstrap \code{"res_bs"}, a fixed design bootstrap \code{"fixed_design_bs"},
a fixed design null bootstrap \code{"fixed_design_bs_Hnull"}, a hybrid null
bootstrap \code{"hybrid_null_bs"} as bootstrap resampling schemes to perform
the bootstrap. This function gives the corresponding p-values, the true test
statistic and the bootstrap-version test statistics. Furthermore, it also
gives the estimated slope.The default (and valid) method implemented
in this function is the null bootstrap, together with the equivalent test
statistic. Via the \code{bootstrapOptions} argument, the user can specify other
bootstrap resampling schemes and test statistics.

```{r example linear regression}
library(BootstrapTests)

n <- 100

# Under H1
X_data <- rnorm(n)
Y_data <-  X_data + rnorm(n)   #Y = X + epsilon
result <- perform_regression_test(X_data, Y_data, nBootstrap = 100,
                       bootstrapOptions =  list(type_boot = "indep",
                                                type_stat = "eq"))
print(result)
plot(result)

# Under H0
X_data <- rnorm(n)
Y_data <-  rep(1, n)  #these values are exactly constant (as b = 0 under H0)
result <- perform_regression_test(X_data, Y_data, nBootstrap = 100)
print(result)
plot(result)

# Showing all theoretically valid options:
result_valid <- perform_regression_test(X_data, Y_data, bootstrapOptions = "all")
print(result_valid)

# Showing all bootstrap combinations, including invalid options:
result_invalid <- perform_regression_test(X_data, Y_data, bootstrapOptions = "all and also invalid")
print(result_invalid)

```


### Goodness-of-fit testing

```{r example GOF}
library(BootstrapTests)

n <- 100
# Under H1
X_data <- rgamma(n,2,3)
result <- perform_GoF_test(X_data,
                         nBootstrap = 100,
                         bootstrapOptions = list(type_boot = "null",
                                                 type_stat = "eq",
                                                 param_bs = "canonical")
                        )
print(result)
plot(result)

# Under H0
X_data <- rnorm(n)
result <- perform_GoF_test(X_data, nBootstrap = 100)
print(result)
plot(result)
```


## References

To be included



